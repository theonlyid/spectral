<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.1" />
<title>spectral.classify API documentation</title>
<meta name="description" content="Module for classifying timeseries data based on their spectral properties â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>spectral.classify</code></h1>
</header>
<section id="section-intro">
<p>Module for classifying timeseries data based on their spectral properties.</p>
<p>This module enables the classification of STFT transformed data
by training an SVM classifier.</p>
<p>This facilitates the identification of various events (defined as transient spatio-temporal patterns of activity)
present within the timeseries data, that have been identified.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Module for classifying timeseries data based on their spectral properties.

This module enables the classification of STFT transformed data
by training an SVM classifier.

This facilitates the identification of various events (defined as transient spatio-temporal patterns of activity)
present within the timeseries data, that have been identified.
&#34;&#34;&#34;

import sklearn
import numpy as np
import scipy


def generate_features(data, labels, **kwargs):
    &#34;&#34;&#34;
    Generate a feature vector for training a classifier
    
    Parameters
    ----------
    data: array
        array with structure
    labels: array
        vector with class labels
        
    Returns
    -------
    X: array
        an array with the features in the 1st axis and trials on the 0-th axis
    y: array
        a vector with the same number of rows as X containing class labels
    &#34;&#34;&#34;
    data_array = np.array([])

    for trial in range(data.shape[-1]):
        for tbin in range(data.shape[-2]):  # Each timebin
            data_array = np.append(
                data_array,
                [
                    np.mean(data[:, :2, tbin, trial], 1).ravel(),
                    np.mean(data[:, 2:9, tbin, trial], 1).ravel(),
                    np.mean(data[:, 9:20, tbin, trial], 1).ravel(),
                    np.mean(data[:, 20:30, tbin, trial], 1).ravel(),
                    np.mean(data[:, 30:, tbin, trial], 1).ravel(),
                ],
            )

    if &#34;log_transform&#34; in kwargs.items():
        data_array = np.log(np.reshape(data_array, (-1, 30)))
    else:
        data_array = np.reshape(data_array, (-1, 30))

    X = data_array
    y = np.ones(data_array.shape[0]) * labels

    return X, y


def classifySVM(self, X, y):
    &#34;&#34;&#34;
    Trains an SVM-classifier on the data.
    
    Parameters
    ----------
    X: array
        Training data with shape: nobs x features
    y: array
        vector with training labels
        
    Returns
    -------
    scores: array
        a vector of scores with length equal to number of CV-folds
    clf: python object
        the trained classifier as a python object
    &#34;&#34;&#34;

    ds = np.append(X, y, axis=1)
    np.random.seed(42)
    np.random.shuffle(ds)

    clf = sklearn.svm.SVC(
        C=1.0,
        cache_size=200,
        class_weight=&#34;balanced&#34;,
        coef0=0.0,
        decision_function_shape=&#34;ovr&#34;,
        degree=3,
        gamma=&#34;scale&#34;,
        kernel=&#34;rbf&#34;,
        max_iter=-1,
        probability=True,
        random_state=42,
        shrinking=True,
        tol=0.001,
        verbose=0,
    )

    cv = sklearn.model_selection.StratifiedKFold(
        n_splits=5, random_state=42, shuffle=True
    )
    print(&#34;Performing 5x5 cross-validation on dataset&#34;)
    scores = sklearn.model_selection.cross_val_score(
        clf, X, y, cv=cv, scoring=&#34;balanced_accuracy&#34;
    )
    print(
        &#34;cross-validation accuracy: %0.2f (+/- %0.2f CI)&#34;
        % (scores.mean(), scores.std() * 2)
    )

    return scores, clf</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="spectral.classify.classifySVM"><code class="name flex">
<span>def <span class="ident">classifySVM</span></span>(<span>self, X, y)</span>
</code></dt>
<dd>
<div class="desc"><p>Trains an SVM-classifier on the data.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>X</code></strong> :&ensp;<code>array</code></dt>
<dd>Training data with shape: nobs x features</dd>
<dt><strong><code>y</code></strong> :&ensp;<code>array</code></dt>
<dd>vector with training labels</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>scores</code></strong> :&ensp;<code>array</code></dt>
<dd>a vector of scores with length equal to number of CV-folds</dd>
<dt><strong><code>clf</code></strong> :&ensp;<code>python object</code></dt>
<dd>the trained classifier as a python object</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def classifySVM(self, X, y):
    &#34;&#34;&#34;
    Trains an SVM-classifier on the data.
    
    Parameters
    ----------
    X: array
        Training data with shape: nobs x features
    y: array
        vector with training labels
        
    Returns
    -------
    scores: array
        a vector of scores with length equal to number of CV-folds
    clf: python object
        the trained classifier as a python object
    &#34;&#34;&#34;

    ds = np.append(X, y, axis=1)
    np.random.seed(42)
    np.random.shuffle(ds)

    clf = sklearn.svm.SVC(
        C=1.0,
        cache_size=200,
        class_weight=&#34;balanced&#34;,
        coef0=0.0,
        decision_function_shape=&#34;ovr&#34;,
        degree=3,
        gamma=&#34;scale&#34;,
        kernel=&#34;rbf&#34;,
        max_iter=-1,
        probability=True,
        random_state=42,
        shrinking=True,
        tol=0.001,
        verbose=0,
    )

    cv = sklearn.model_selection.StratifiedKFold(
        n_splits=5, random_state=42, shuffle=True
    )
    print(&#34;Performing 5x5 cross-validation on dataset&#34;)
    scores = sklearn.model_selection.cross_val_score(
        clf, X, y, cv=cv, scoring=&#34;balanced_accuracy&#34;
    )
    print(
        &#34;cross-validation accuracy: %0.2f (+/- %0.2f CI)&#34;
        % (scores.mean(), scores.std() * 2)
    )

    return scores, clf</code></pre>
</details>
</dd>
<dt id="spectral.classify.generate_features"><code class="name flex">
<span>def <span class="ident">generate_features</span></span>(<span>data, labels, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Generate a feature vector for training a classifier</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>array</code></dt>
<dd>array with structure</dd>
<dt><strong><code>labels</code></strong> :&ensp;<code>array</code></dt>
<dd>vector with class labels</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>X</code></strong> :&ensp;<code>array</code></dt>
<dd>an array with the features in the 1st axis and trials on the 0-th axis</dd>
<dt><strong><code>y</code></strong> :&ensp;<code>array</code></dt>
<dd>a vector with the same number of rows as X containing class labels</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def generate_features(data, labels, **kwargs):
    &#34;&#34;&#34;
    Generate a feature vector for training a classifier
    
    Parameters
    ----------
    data: array
        array with structure
    labels: array
        vector with class labels
        
    Returns
    -------
    X: array
        an array with the features in the 1st axis and trials on the 0-th axis
    y: array
        a vector with the same number of rows as X containing class labels
    &#34;&#34;&#34;
    data_array = np.array([])

    for trial in range(data.shape[-1]):
        for tbin in range(data.shape[-2]):  # Each timebin
            data_array = np.append(
                data_array,
                [
                    np.mean(data[:, :2, tbin, trial], 1).ravel(),
                    np.mean(data[:, 2:9, tbin, trial], 1).ravel(),
                    np.mean(data[:, 9:20, tbin, trial], 1).ravel(),
                    np.mean(data[:, 20:30, tbin, trial], 1).ravel(),
                    np.mean(data[:, 30:, tbin, trial], 1).ravel(),
                ],
            )

    if &#34;log_transform&#34; in kwargs.items():
        data_array = np.log(np.reshape(data_array, (-1, 30)))
    else:
        data_array = np.reshape(data_array, (-1, 30))

    X = data_array
    y = np.ones(data_array.shape[0]) * labels

    return X, y</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="spectral" href="index.html">spectral</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="spectral.classify.classifySVM" href="#spectral.classify.classifySVM">classifySVM</a></code></li>
<li><code><a title="spectral.classify.generate_features" href="#spectral.classify.generate_features">generate_features</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.1</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>